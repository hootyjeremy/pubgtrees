let vm=new Vue({el:"#vueapp",data:{match_data:[],strTeamRoster:""},created:function(){},methods:{getMatchData:function(matches_array){this.match_data=matches_array},resolveMatchType:function(match_type){return"competitive"==match_type?"Yes":"No"},resolveKnocks:function(mode,knocks){return"solo"==mode||"solo-fpp"==mode?"-":knocks},printRoster:function(matchRoster,player_name){var strRoster="";for(let i=0;i<matchRoster.length;i++)matchRoster[i].name!=player_name&&(strRoster+=", "+matchRoster[i].name);return strRoster=""!=strRoster?player_name+strRoster:player_name,1==matchRoster.length&&(strRoster=player_name),strRoster},analyzeMatch:function(_matchId,index){for(let i=0;i<this.match_data.length;i++)i==index?document.getElementById("matchRow"+i).classList.add("activeMatchRow"):document.getElementById("matchRow"+i).classList.remove("activeMatchRow");GetTelemetry(_matchId)}}}),vueMatchInfo=new Vue({el:"#d3-tree01",data:{createdAt:null,duration:null,gameMode:null,id:null,mapName:null,matchType:null,shardId:null,participantCount:"0"},methods:{updateTreeMatchDetails:function(matchDetails,arrMatches){null==arrMatches?this.participantCount="-":arrMatches.forEach(match=>{match.matchId==matchDetails.id&&(this.participantCount=match.participantCount)}),this.createdAt=matchDetails.createdAt,this.duration=matchDetails.duration,this.gameMode=matchDetails.gameMode.toUpperCase(),this.id=matchDetails.id,this.mapName=matchDetails.mapName.toUpperCase(),this.matchType=vm.resolveMatchType(matchDetails.matchType),this.shardId=matchDetails.shardId}}}),vuePlayerReport=new Vue({el:"#div-modal",data:{selectedPlayer:null,kills:null,damageDealt:null,DBNOs:null,timeSurvived:null,winPlace:null,teamKills:null,rowId:null,arrPlayerReport:[],isHidden:!0,isWinner:!1,isHideTeamId:!0,hitLocations:{},headPercentage:0,bodyPercentage:0,pelvisPercentage:0,armPercentage:0,legPercentage:0},methods:{updatePlayerReport:function(name,killer,playerTeam,killerTeam,arrPlayerCards,arrPlayersDamageLog,allBotNames,allHumanNames){allBotNames.includes(name)?document.getElementById("div-reportStats").style.display="none":document.getElementById("div-reportStats").style.display="block",this.selectedPlayer=name,this.hitLocations.head=0,this.hitLocations.body=0,this.hitLocations.pelvis=0,this.hitLocations.arm=0,this.hitLocations.leg=0,this.kills="(invalid, bot)",this.damageDealt="(invalid, bot)",this.DBNOs="(invalid, bot)",this.timeSurvived="(invalid, bot)",this.winPlace="(invalid, bot)",this.teamKills="(invalid, bot)",arrPlayerCards.forEach(element=>{element.name==name&&(this.kills=element.kills,this.damageDealt=parseInt(element.damageDealt).toLocaleString("en"),this.DBNOs=element.DBNOs,this.timeSurvived=element.timeSurvived,this.winPlace=element.winPlace,this.teamKills=element.teamKills,1==this.winPlace?(this.isWinner=!0,document.getElementById("div-winBanner").style.display="block",document.getElementById("div-loseBanner").style.display="none"):(this.isWinner=!1,document.getElementById("div-winBanner").style.display="none",document.getElementById("div-loseBanner").style.display="block"))}),rowId=0,this.arrPlayerReport=[],arrPlayersDamageLog.forEach(record=>{if(record.attacker.name==this.selectedPlayer||record.victim.name==this.selectedPlayer){let _event="",_info="",_distance="",attackerName=record.attacker.name,victimName=record.victim.name,attackerHealth="",victimHealth="",armor="",attackerClass="",victimClass="",rowClass="",attackerClickable="",victimClickable="",attackerOnClick="javascript:void(0)",victimOnClick="javascript:void(0)",zone="",blAttackerIsBot=!1,blVictimIsBot=!1;if("LogPlayerTakeDamage"==record._T){if(attackerName==name&&("HeadShot"==record.damageReason?this.hitLocations.head++:"TorsoShot"==record.damageReason?this.hitLocations.body++:"PelvisShot"==record.damageReason?this.hitLocations.pelvis++:"LegShot"==record.damageReason?this.hitLocations.leg++:"ArmShot"==record.damageReason&&this.hitLocations.arm++),this.isHidden)return;if(!chkIncoming.checked&&attackerName!=name)return;_event=record.damage>0&&record.damage<2?record.damage.toFixed(1):parseInt(record.damage),attackerHealth=record.attacker.health>0&&record.attacker.health<2?record.attacker.health.toFixed(1):parseInt(record.attacker.health),victimHealth=record.victim.healthAfterDamage>0&&record.victim.healthAfterDamage<2?record.victim.healthAfterDamage.toFixed(1):parseInt(record.victim.healthAfterDamage),_info=this.resolveDamageReason(record.damageCauserName,record.damageReason,record.damageTypeCategory),"HeadShot"==record.damageReason?armor=this.translateHead(record.victim.armor.head):"TorsoShot"==record.damageReason&&(armor=this.translateVest(record.victim.armor.vest)),record.selfDamage&&(_info+=" (Self-damage)"),record.killingStroke}else if("LogPlayerMakeGroggy"==record._T)_event="▼",rowClass="rowKill",record.teammateKnock?_info+=" (Teammate-knock)":record.selfKnock&&(_info+=" (Self-knock)");else if("LogPlayerRevive"==record._T){if(record.attacker.name==this.selectedPlayer)return;_event="∧"}else"LogPlayerKill"==record._T&&(_event="╳",rowClass="rowKill",record.isThirst&&(_info+=" (Thirsted)"),record.isSelfKill&&(_info+=" (Self-kill)"),record.isNoRevive?_info+=" (Bleedout/No-revive)":record.isTeamWipe&&(_info+=" (Bleedout/Team-wiped)"));null!=record.distance&&(_distance=-1==record.distance?"- - - - -":0==record.distance?"- - - - -":record.distance.toLocaleString("en")+" m");let _damager=this.resolveDamager(record.damageCauserName,record.damageReason,record.damageTypeCategory);if(record.attacker.name==this.selectedPlayer&&(attackerClass="selectedPlayer"),record.victim.name==this.selectedPlayer&&(victimClass="selectedPlayer"),allBotNames.includes(record.attacker.name)&&(attackerClass="botPlayer"),allBotNames.includes(record.victim.name)&&(victimClass="botPlayer"),attackerName==killer&&attackerName!=name&&(attackerClass="killer",allBotNames.includes(killer)&&(blAttackerIsBot=!0)),victimName==killer&&victimName!=name&&(victimClass="killer",allBotNames.includes(killer)&&(blVictimIsBot=!0)),attackerName!=killer&&""!=killer&&0!=killerTeam){let killedByTeammate=0;killerTeam.teammates.forEach(teammate=>{teammate.name==killer?killedByTeammate++:teammate.name==name&&killedByTeammate++}),killerTeam.teammates.forEach(teammate=>{attackerName==teammate.name&&(teammate.isBot&&(blAttackerIsBot=!0),2!=killedByTeammate&&(attackerClass="killerTeammate"))})}if(victimName!=killer&&""!=killer&&0!=killerTeam){let killedByTeammate=0;killerTeam.teammates.forEach(teammate=>{teammate.name==killer?killedByTeammate++:teammate.name==name&&killedByTeammate++}),killerTeam.teammates.forEach(teammate=>{victimName==teammate.name&&(teammate.isBot&&(blVictimIsBot=!0),2!=killedByTeammate&&(victimClass="killerTeammate"))})}attackerName!=name&&playerTeam.teammates.forEach(teammate=>{attackerName==teammate.name&&(teammate.isBot&&(blAttackerIsBot=!0),attackerClass="playerTeammate")}),victimName!=name&&playerTeam.teammates.forEach(teammate=>{victimName==teammate.name&&(teammate.isBot&&(blVictimIsBot=!0),victimClass="playerTeammate")}),allHumanNames.includes(attackerName)&&(attackerClickable="clickable",attackerOnClick="SearchNewPlayer('"+attackerName+"')"),allHumanNames.includes(victimName)&&(victimClickable="clickable",victimOnClick="SearchNewPlayer('"+victimName+"')"),"Grenade"!=_damager&&"Molotov"!=_damager||(_distance=""),""!=record.victim.zone[0]&&(zone=translateZone(record.victim.zone[0])),blAttackerIsBot?attackerName="bot-"+attackerName:allHumanNames.includes(attackerName)||attackerName.includes("<")||(attackerName="bot-"+attackerName),blVictimIsBot?victimName="bot-"+victimName:allHumanNames.includes(victimName)||victimName.includes("<")||(victimName="bot-"+victimName),record.attacker.teamId>99999&&(record.attacker.teamId-=1e5),record.victim.teamId>99999&&(record.victim.teamId-=1e5),this.arrPlayerReport.push({rowId:rowId,matchTime:record.matchTime,attacker:attackerName,victim:victimName,event:_event,damagerInfo:_damager,distance:_distance,info:_info,attackerClass:attackerClass,victimClass:victimClass,attackerHealth:attackerHealth,victimHealth:victimHealth,attackerClickable:attackerClickable,victimClickable:victimClickable,attackerOnClick:attackerOnClick,victimOnClick:victimOnClick,attackerTeamId:record.attacker.teamId,victimTeamId:record.victim.teamId,zone:zone,rowClass:rowClass,armor:armor}),rowId++}}),this.insertSpacerRows(),totalHits=this.hitLocations.head+this.hitLocations.body+this.hitLocations.pelvis+this.hitLocations.arm+this.hitLocations.leg,totalHits>0&&(this.headPercentage=(100*this.hitLocations.head/totalHits).toFixed(1),this.bodyPercentage=(100*this.hitLocations.body/totalHits).toFixed(1),this.pelvisPercentage=(100*this.hitLocations.pelvis/totalHits).toFixed(1),this.armPercentage=(100*this.hitLocations.arm/totalHits).toFixed(1),this.legPercentage=(100*this.hitLocations.leg/totalHits).toFixed(1))},clearPlayerReport:function(){this.arrPlayerReport=[]},insertSpacerRows:function(){if(this.arrPlayerReport.length>1){let prevMatchTime=new Date("2000-01-01T00:"+this.arrPlayerReport[0].matchTime);for(let i=0;i<this.arrPlayerReport.length;i++){let currMatchTime;new Date("2000-01-01T00:"+this.arrPlayerReport[i].matchTime).getTime()-prevMatchTime>3e4&&this.arrPlayerReport.splice(i,0,{rowId:"-",matchTime:"...",attacker:"",victim:"",event:"",damagerInfo:"",distance:"",info:"",attackerClass:"",victimClass:"",attackerHealth:"",victimHealth:"",zone:"",rowClass:"blankRow",armor:""}),prevMatchTime=new Date("2000-01-01T00:"+this.arrPlayerReport[i].matchTime).getTime(),this.arrPlayerReport[i].rowId=i}}},resolveDamager:function(damageCauserName,damageReason,damageTypeCategory){let _damager="";return"Gun"==damageTypeCategory?_damager=damageCauserName:"Fall Damage"==damageTypeCategory||"Punch"==damageTypeCategory||"Melee"==damageTypeCategory||"Bluezone"==damageTypeCategory||"Blackzone"==damageTypeCategory||"Redzone"==damageTypeCategory?_damager=damageTypeCategory:"Grenade Explosion"==damageTypeCategory?_damager="Grenade":"C4 Explosion"==damageTypeCategory?_damager="C4":"Molotov"==damageTypeCategory?_damager="Molotov":"Vehicle Crash"==damageTypeCategory||"Vehicle Hit"==damageTypeCategory?_damager="Vehicle":(console.log(strLine),console.log("unaccounted damageTypeCategory..."),console.log("damageTypeCategory=",damageTypeCategory+" | damageCauserName=",damageCauserName+" | damageReason=",damageReason)),_damager},resolveDamageReason:function(damageCauserName,damageReason,damageTypeCategory){let r="";return null!=damageReason&&"NonSpecific"!=damageReason&&(r=damageReason,"TorsoShot"==damageReason?r="Body":"LegShot"==damageReason?r="Leg":"ArmShot"==damageReason?r="Arm":"HeadShot"==damageReason?r="Headshot":"PelvisShot"==damageReason&&(r="Pelvis")),r},translateHead(head){let r="";return null==head?r="static/images/gear/minus (1)-white-small.png":"Item_Head_E_01_Lv1_C"==head?r="static/images/gear/helmet-level1.png":"Item_Head_E_02_Lv1_C"==head?r="static/images/gear/helmet-level1.png":"Item_Head_F_01_Lv2_C"==head?r="static/images/gear/helmet-level2.png":"Item_Head_F_02_Lv2_C"==head?r="static/images/gear/helmet-level2.png":"Item_Head_G_01_Lv3_C"==head&&(r="static/images/gear/helmet-level3.png"),r},translateVest(vest){let r="";return null==vest?r="static/images/gear/minus (1)-white-small.png":"Item_Armor_C_01_Lv3_C"==vest?r="static/images/gear/vest-level3.png":"Item_Armor_D_01_Lv2_C"==vest?r="static/images/gear/vest-level2.png":"Item_Armor_E_01_Lv1_C"==vest&&(r="static/images/gear/vest-level1.png"),r}}});