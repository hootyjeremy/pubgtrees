let strLine="--------------------------------------------",hooty_server_url="http://localhost:3000",version="0.059";const blTestingVersion=!0;var strPlatform,strPlayerName,prevPlatform,prevPlayerName;console.log("testing version: "+version),console.log("you are at: "+location.href);let glSelectedPlayer=null,prevSelectedPlayer=null,glMatchId="",bypassCache=null;var url,player_url,match_url,telemetry_url="",player_response_json,match_response_json,telemetry_response_json,total_matches=0;let match_floors=[0],match_floors_index=0,searchDirection=null;var axios_matches_response=null;let axios_telemetry_response=null,chkIncoming=null,chkDefault=null,glTreeWidth=null,glTreeHeight=null,glTreeHeightPos=null,glTreeHeightNeg=null,glPlayerRectangle=null,blClickedPlayer=!1;function ShowModal(){document.getElementById("div-modal").style.display="block",document.getElementById("div-modal").scrollIntoView({behavior:"smooth"})}function HideModal(){document.getElementById("div-modal").style.display="none",vuePlayerReport.clearPlayerReport()}function checkURLQuery(){const tmpURL=new URL(location);let paramType=tmpURL.searchParams.get("type"),paramMatchId=tmpURL.searchParams.get("matchid"),paramPlayer=tmpURL.searchParams.get("player"),paramPlatform=tmpURL.searchParams.get("platform");if(""!=tmpURL.search){if(null==paramType||null==paramPlayer||null==paramPlatform)return alert("The link has invalid search parameters. See console log."),console.log("URL search parameter error: Check that all 4 parameters are present and spelled correctly: type, matchid, player, and platform."),void history.replaceState("","","/");document.getElementById("inputPlayerName").value=paramPlayer,document.getElementById("slcPlatform").value=paramPlatform,strPlayerName=paramPlayer,strPlatform=paramPlatform,"player"==paramType?(console.log("url query: "+tmpURL.search),btnSearchPlayer_Click(),history.pushState("","",location)):"match"==paramType&&(console.log("url query: "+tmpURL.search),GetTelemetry(paramMatchId),history.pushState("","",location))}}function btnCopyMatchToClipboard_Click(){navigator.permissions.query({name:"clipboard-write"}).then(result=>{if("granted"==result.state||"prompt"==result.state){let clip=hooty_server_url+"/?type=match&matchid="+glMatchId+"&player="+strPlayerName+"&platform="+strPlatform;navigator.clipboard.writeText(clip).then((function(){}),(function(){alert("Could not copy to the clipboard.")}))}})}function SearchNewPlayer(player){let tmpURL=hooty_server_url+"/?type=player&matchid=null&player="+player+"&platform="+strPlatform;window.open(tmpURL,"_blank")}async function GetPlayerMatches(){let blCeilingHit=!1,blFloorHit=!1;chkDefault.checked&&(strPlayerName.length>0&&(localStorage.setItem("defaultPlayer",strPlayerName),localStorage.setItem("defaultPlatform",strPlatform)),chkDefault.checked=!1,document.getElementById("lblDefault").textContent="Set as default player"),strPlatform==prevPlatform&&strPlayerName==prevPlayerName||(console.log("resetting match_floor for new player"),match_floors=[0],match_floors_index=0),prevPlatform=strPlatform,prevPlayerName=strPlayerName,console.log("requesting player: "+strPlatform+"/"+strPlayerName);const btnSearch=document.getElementById("btnSearchPlayer"),btnPrevious=document.getElementById("btnPreviousMatches"),btnNext=document.getElementById("btnNextMatches");btnSearch.disabled=btnPrevious.disabled=btnNext.disabled=!0,document.body.style.cursor="wait",document.getElementById("fetching").style.display="block",document.getElementById("vueapp").style.display="none",document.getElementById("div-analyzing").style.display="none",document.getElementById("d3-tree01").style.display="none",document.getElementById("vue-obituaries").style.display="none",console.log("match_floors["+match_floors_index+"]: "+match_floors[match_floors_index]);try{axios_matches_response=await axios.get(hooty_server_url+"/getplayermatches",{params:{endpoint:"players",platform:strPlatform,player_name:strPlayerName,match_floor:match_floors[match_floors_index],searchDirection:searchDirection,match_id:"",telemetry_id:"",bypassCache:bypassCache},headers:{"Content-Encoding":"gzip"}})}catch(error){return alert("There was an error with the request. See the developer tools' console log for fetching errors."),document.body.style.cursor="default",void(document.getElementById("fetching").style.display="none")}if(200!=axios_matches_response.data.pubgResponse.status&&null!=axios_matches_response.data.pubgResponse.status)return 429==axios_matches_response.data.pubgResponse.status?(console.log("ERROR: pubg api rate limit hit: "+axios_matches_response.data.pubgResponse.status+", "+axios_matches_response.data.pubgResponse.statusText),console.log(axios_matches_response.data.pubgResponse),alert("Rate limited exceeded. Please try again in 60 seconds.")):(console.log("ERROR: could not find player in pubg api. Check spelling and uppercase/lowercase. It must match their in game name exactly. "+axios_matches_response.data.status+", "+axios_matches_response.data.statusText),console.log(axios_matches_response.data.pubgResponse),alert("Could not find player in pubg api. Check spelling and uppercase/lowercase. It must match their in game name exactly.")),btnSearch.disabled=btnPrevious.disabled=btnNext.disabled=!1,document.body.style.cursor="default",void(document.getElementById("fetching").style.display="none");for(console.log("bypassCache: "+bypassCache),console.log("matches_response.data..."),console.dir(axios_matches_response.data),console.log("current match_floor: "+match_floors[match_floors_index]+" of "+axios_matches_response.data.totalMatches+", new ceiling: "+axios_matches_response.data.match_ceiling),console.log("total matches: "+axios_matches_response.data.totalMatches),console.log("hootyserver getMatches response -> "+axios_matches_response.data.pubgResponse.hootyserver),match_floors.length==match_floors_index+1&&match_floors.push(axios_matches_response.data.match_ceiling),blCeilingHit=!(axios_matches_response.data.match_ceiling<axios_matches_response.data.totalMatches),blFloorHit=0==match_floors_index,btnSearch.disabled=btnPrevious.disabled=btnNext.disabled=!1,blFloorHit?(btnPrevious.disabled=!0,btnPrevious.classList.add("disabledButton")):(btnPrevious.disabled=!1,btnPrevious.classList.remove("disabledButton")),blCeilingHit?(btnNext.disabled=!0,btnNext.classList.add("disabledButton")):(btnNext.disabled=!1,btnNext.classList.remove("disabledButton")),i=0;i<axios_matches_response.data.matches.length;i++)0==axios_matches_response.data.matches[i].DBNOs&&(axios_matches_response.data.matches[i].DBNOs="-"),0==axios_matches_response.data.matches[i].kills&&(axios_matches_response.data.matches[i].kills="-"),0==axios_matches_response.data.matches[i].damageDealt&&(axios_matches_response.data.matches[i].damageDealt="-");vm.getMatchData(axios_matches_response.data.matches),document.getElementById("btnPreviousMatches").style.display="block",document.getElementById("btnNextMatches").style.display="block",document.getElementById("vueapp").style.display="block",document.getElementById("fetching").style.display="none",document.body.style.cursor="default",0==axios_matches_response.data.totalMatches&&(alert("The player was found but they have no recent matches."),document.getElementById("vueapp").style.display="none",document.getElementById("d3-tree01").style.display="none",document.getElementById("vue-obituaries").style.display="none")}async function GetTelemetry(_matchID){console.log("Match diag -> platform: "+strPlatform+", matchId: "+_matchID+", player: '"+strPlayerName+"'"),glMatchId=_matchID,axios_telemetry_response=null,document.body.style.cursor="wait",document.getElementById("div-analyzing").style.display="block",document.getElementById("d3-tree01").style.display="none",document.getElementById("vue-obituaries").style.display="none";try{axios_telemetry_response=await axios.get(hooty_server_url+"/getmatchtelemetry",{params:{platform:strPlatform,matchID:_matchID,player_name:strPlayerName},headers:{"Content-Encoding":"gzip"}})}catch(error){return alert("Error getting match details: "+error.message),document.body.style.cursor="default",document.getElementById("div-analyzing").style.display="none",document.getElementById("d3-tree01").style.display="none",void(document.getElementById("vue-obituaries").style.display="none")}if(null!=axios_telemetry_response.data.pubgApiMatchResponseInfo.status&&200!=axios_telemetry_response.data.pubgApiMatchResponseInfo.status)return alert("This match no longer exists."),document.body.style.cursor="default",document.getElementById("div-analyzing").style.display="none",document.getElementById("d3-tree01").style.display="none",void(document.getElementById("vue-obituaries").style.display="none");if(null==axios_matches_response?vueMatchInfo.updateTreeMatchDetails(axios_telemetry_response.data.matchDetails,null):vueMatchInfo.updateTreeMatchDetails(axios_telemetry_response.data.matchDetails,axios_matches_response.data.matches),200!=axios_telemetry_response.data.pubgApiMatchResponseInfo.status&&null!=axios_telemetry_response.data.pubgApiMatchResponseInfo.status)return alert("Error getting match from pubg api. "+axios_telemetry_response.data.pubgApiMatchResponseInfo.status+": "+axios_telemetry_response.data.pubgApiMatchResponseInfo.statusText),document.body.style.cursor="default",document.getElementById("div-analyzing").style.display="none",document.getElementById("d3-tree01").style.display="none",void(document.getElementById("vue-obituaries").style.display="none");console.log("telemetry_response.data..."),console.dir(axios_telemetry_response.data);try{document.getElementById("d3-svg01").innerHTML="",CreateTreeFromD3(),SetRectangleLocation(strPlayerName),document.getElementById("div-analyzing").style.display="none",document.getElementById("d3-tree01").style.display="block"}catch(error){return"cycle"==error.message?alert("There is an error creating the tree structure for this match because of 'circular kills.'\n\nI can currently detect if player A kills B and B also kills player A which creates a loop and breaks the tree hierarchy structure but I have not accounted for cases where player A kills B who kills C and then player C kills A or any other larger loops. These are pretty rare but I will need to sit down and get it cleaned up. For now, I cannot draw the match tree and I apologize."):alert("D3 tree error: "+error.message),document.body.style.cursor="default",document.getElementById("div-analyzing").style.display="none",void(document.getElementById("d3-tree01").style.display="none")}try{""!=strPlayerName&&document.getElementById(strPlayerName).classList.add("searchedPlayer"),vueObituaries.updateObituaries(axios_telemetry_response.data.arrKillLog,axios_telemetry_response.data.arrPlayerCards,axios_telemetry_response.data.arrSurvivors),document.getElementById("vue-obituaries").style.display="block",document.body.style.cursor="default",document.getElementById("d3-tree01").scrollIntoView({behavior:"smooth"})}catch(error){return console.log("error in ClearTreeContext() for player "+strPlayerName+" -> "+error),alert("An error occurred while updating player colors. The player you searched for has possibly changed their name after this game was played."),void(document.body.style.cursor="default")}}function RunPlayerDamageReport(selectedPlayer){glSelectedPlayer=selectedPlayer;let playerTeam=0;axios_telemetry_response.data.arrTeams.forEach(team=>{team.teammates.forEach(teammate=>{teammate.name==selectedPlayer&&(playerTeam=team)})});let tmpKiller="";axios_telemetry_response.data.arrKillLog.forEach(element=>{element.victim!=selectedPlayer||(tmpKiller=element.killer)});let killerTeam=0;""!=tmpKiller&&axios_telemetry_response.data.arrTeams.forEach(team=>{team.teammates.forEach(teammate=>{teammate.name!=tmpKiller||(killerTeam=team)})}),vuePlayerReport.updatePlayerReport(selectedPlayer,tmpKiller,playerTeam,killerTeam),vuePlayerReport.arrPlayerReport.length>0?(document.getElementById("reportTable").style.display="table",document.getElementById("alt-reportTable").style.display="none"):(document.getElementById("reportTable").style.display="none",document.getElementById("alt-reportTable").style.display="block"),ShowModal()}function PrintReportForSelectedPlayer(selectedPlayer){var record,line,attackerTeamId,victimTeamId,attackerName,victimName,killingStroke,teammateDamage,selfDamage,_thirst,_selfKill,_teammateKill,line,attackerTeamId,victimTeamId,attackerName,victimName,_thirst,_selfKill,_teammateKill}function CreateTreeFromD3(){const response=axios_telemetry_response.data;let table=d3.csvParse(response.csvDataForD3);const root=d3.stratify().id((function(d){return d.name})).parentId((function(d){return d.parent}))(table),path_width=1200,dx=14,dy=140,tree=d3.tree().nodeSize([14,dy]);glTreeWidth=160+root.height*dy,glTreeHeight=0,glTreeHeightNeg=0,glTreeHeightPos=0,tree(root);let x0=1/0,x1=-x0;root.each(d=>{d.x>x1&&(x1=d.x),d.x<x0&&(x0=d.x),d.x<0?d.x<glTreeHeightNeg&&(glTreeHeightNeg=d.x):d.x>glTreeHeightPos&&(glTreeHeightPos=d.x)}),glTreeHeight=Math.abs(glTreeHeightNeg)+glTreeHeightPos+40;const svg=d3.select(document.getElementById("d3-svg01")).style("width",glTreeWidth).style("height",glTreeHeight).style("background-color","#414144"),g=svg.append("g").attr("id","g-child").attr("font-family","sans-serif").attr("font-size",12).attr("transform",`translate(10,${14-x0})`),link=g.append("g").attr("fill","none").attr("stroke-opacity",.4).attr("stroke-width",1.5).selectAll("path").data(root.links()).enter().append("path").attr("stroke",d=>"Match"==d.source.id?"#414144":"#8f91a1").attr("d",d3.linkHorizontal().x(d=>d.y).y(d=>d.x)).attr("id",d=>"path-"+d.source.id+"-"+d.target.id).attr("class",d=>"Match"==d.source.id?"d3-path pathHidden":"d3-path pathDefault"),node=g.append("g").selectAll("g").data(root.descendants()).enter().append("g").attr("transform",d=>`translate(${d.y},${d.x})`);node.append("circle").attr("fill",d=>{}).attr("r",2.5).attr("id",d=>"circle-"+d.data.name).attr("class","d3-circle"),node.append("text").attr("fill","#dcddde").attr("class",d=>{let winnerClass="";return response.allHumanNames.includes(d.data.name)?(response.arrPlayerCards.forEach(player=>{player.name==d.data.name&&1==player.winPlace&&(winnerClass=" winner")}),"allPlayers humanPlayers"+winnerClass):response.allBotNames.includes(d.data.name)?(response.arrSurvivors.forEach(element=>{element.name==d.data.name&&(winnerClass=" winner")}),d.data.name.includes(".npc")&&(winnerClass=""),"allPlayers botPlayers"+winnerClass):"Winner"==d.data.name||"Winners"==d.data.name?"categories winner":"Match"==d.data.name||"Environment"==d.data.name||"Self kills"==d.data.name||"Circular kills"==d.data.name||"Haven"==d.data.name?"categories":d.data.name.includes("<")?"categories":d.data.name.includes("(")?"categories":void 0}).attr("id",d=>{if(response.allHumanNames.includes(d.data.name)||response.allBotNames.includes(d.data.name))return d.data.name}).attr("onclick",d=>{if(response.allHumanNames.includes(d.data.name))return"UpdateTreeContext('"+d.data.name+"', true)"}).attr("cursor",d=>"Match"==d.data.name||"Winner"==d.data.name||"Winners"==d.data.name||"Environment"==d.data.name||"Self kills"==d.data.name||"Circular kills"==d.data.name||"Haven"==d.data.name||d.data.name.includes("<")||d.data.name.includes("(")||!response.allHumanNames.includes(d.data.name)?"normal":"pointer").attr("dy","0.36em").attr("x",d=>"Winner"==d.data.name||"Winners"==d.data.name||"Environment"==d.data.name||"Self kills"==d.data.name||"Circular kills"==d.data.name||"Haven"==d.data.name?-6:6).attr("text-anchor",d=>"Winner"==d.data.name||"Winners"==d.data.name||"Environment"==d.data.name||"Self kills"==d.data.name||"Circular kills"==d.data.name||"Haven"==d.data.name?"end":"start").text(d=>"Match"==d.data.name?"":"Winner"==d.data.name||"Winners"==d.data.name||"Environment"==d.data.name||"Self kills"==d.data.name||"Circular kills"==d.data.name||"Haven"==d.data.name?"<"+d.data.name+">":response.allHumanNames.includes(d.data.name)||d.data.name.includes("<")||d.data.name.includes("(")?d.data.name:d.data.name.includes(".npc")?d.data.name:d.data.name.length>10?"bot."+d.data.name.substring(0,10)+"~":"bot."+d.data.name).select((function(){return this.parentNode.insertBefore(this.cloneNode(!0),this)})).attr("stroke","#414144").attr("stroke-linejoin","round").attr("stroke-width",3).attr("id","fake-invalid-id").attr("onclick","javacript.void(0);")}function ClearTreeContext(){glSelectedPlayer="",prevSelectedPlayer="";let allPlayers=document.getElementsByClassName("allPlayers"),allCircles=document.getElementsByClassName("d3-circle"),allPaths=document.getElementsByClassName("d3-path");for(let i=0;i<allPlayers.length;i++){if("fake-invalid-id"==allPlayers[i].id)continue;let playerClassList=allPlayers[i].classList,circleClassList=document.getElementById("circle-"+allPlayers[i].id).classList;axios_telemetry_response.data.arrPlayerCards.forEach(element=>{element.name==allPlayers[i].textContent&&(1==element.winPlace&&(playerClassList.add("winner"),circleClassList.add("winner"),element.name.includes(".npc")&&(playerClassList.remove("winner"),circleClassList.remove("winner"))),element.name==strPlayerName&&(playerClassList.add("searchedPlayer"),circleClassList.add("searchedPlayer")))});for(let j=playerClassList.length-1;j>=0;j--)"allPlayers"!=playerClassList[j]&&"humanPlayers"!=playerClassList[j]&&"botPlayers"!=playerClassList[j]&&"searchedPlayer"!=playerClassList[j]&&"winner"!=playerClassList[j]&&playerClassList.remove(playerClassList[j]);for(let j=circleClassList.length-1;j>=0;j--)"d3-circle"!=circleClassList[j]&&"allPlayers"!=circleClassList[j]&&"humanPlayers"!=circleClassList[j]&&"botPlayers"!=circleClassList[j]&&"searchedPlayer"!=circleClassList[j]&&"winner"!=circleClassList[j]&&circleClassList.remove(circleClassList[j])}for(let i=0;i<allCircles.length;i++){let who=allCircles[i].id.substring(7,allCircles[i].id.length);"circle-Winners"==allCircles[i]||"circle-Winner"==allCircles[i]||"circle-Self kills"==allCircles[i]||"circle-Environment"==allCircles[i]||"circle-Circular kills"==allCircles[i]||who.includes("<")?allCircles[i].classList.add("categories"):"circle-Match"==allCircles[i].id?allCircles[i].classList.add("transparent"):axios_telemetry_response.data.allHumanNames.includes(who)?allCircles[i].classList.add("humanPlayers"):allCircles[i].classList.add("botPlayers")}PrunePathClasses(document.getElementsByClassName("d3-path")),SetRectangleLocation(strPlayerName);let obitRows=document.getElementsByClassName("obituaryRow");for(i=0;i<obitRows.length;i++)obitRows[i].classList.remove("obituarySelected"),obitRows[i].id=="obit-"+strPlayerName&&obitRows[i].classList.add("obituarySelected");let obitSelected=document.getElementsByClassName("obit-name");for(i=0;i<obitSelected.length;i++){for(j=0;j<obitSelected[i].classList.length;j++)"obit-name"!=obitSelected[i].classList[j]&&obitSelected[i].classList.remove(obitSelected[i].classList[j]);obitSelected[i].innerText==strPlayerName&&obitSelected[i].classList.add("selectedPlayer")}}function UpdateTreeContext(selectedPlayer,_playerClicked){if(blClickedPlayer=_playerClicked,blClickedPlayer||HideModal(),!axios_telemetry_response.data.allHumanNames.includes(selectedPlayer))return;prevSelectedPlayer==selectedPlayer&&""!=glSelectedPlayer&&RunPlayerDamageReport(selectedPlayer),glSelectedPlayer=selectedPlayer,prevSelectedPlayer=selectedPlayer;const response=axios_telemetry_response.data;let allPlayers=document.getElementsByClassName("allPlayers"),selectedPlayerTeamId=null,selectedPlayerKiller=null,selectedPlayerKillerTeamId=null;response.arrTeams.forEach(element=>{element.teammates.forEach(teammate=>{teammate.name==selectedPlayer&&(selectedPlayerTeamId=element.teamId)})}),response.arrKillLog.forEach(element=>{element.victim==selectedPlayer&&element.killer!=selectedPlayer&&(selectedPlayerKiller=element.killer,response.arrTeams.forEach(team=>{team.teammates.forEach(teammate=>{teammate.name==selectedPlayerKiller&&(selectedPlayerKillerTeamId=team.teamId)})}))});for(let i=0;i<allPlayers.length;i++){if("fake-invalid-id"==allPlayers[i].id)continue;let playerClassList=allPlayers[i].classList,currentPlayer=stripBotText(allPlayers[i].textContent),circleClassList=document.getElementById("circle-"+allPlayers[i].id).classList;for(let j=playerClassList.length-1;j>=0;j--)"allPlayers"!=playerClassList[j]&&"humanPlayers"!=playerClassList[j]&&"botPlayers"!=playerClassList[j]&&playerClassList.remove(playerClassList[j]);for(let j=circleClassList.length-1;j>0;j--)"allPlayers"!=circleClassList[j]&&"humanPlayers"!=circleClassList[j]&&"botPlayers"!=circleClassList[j]&&"transparent"!=circleClassList[j]&&circleClassList.remove(circleClassList[j]);selectedPlayer==currentPlayer?(playerClassList.add("selectedPlayer"),circleClassList.add("selectedPlayer")):response.arrTeams.forEach(team=>{team.teammates.forEach(teammate=>{teammate.name==currentPlayer&&(team.teamId==selectedPlayerTeamId?(playerClassList.add("playerTeammate"),circleClassList.add("playerTeammate")):team.teamId==selectedPlayerKillerTeamId&&(currentPlayer==selectedPlayerKiller?(playerClassList.add("killer"),circleClassList.add("killer")):(playerClassList.add("killerTeammate"),circleClassList.add("killerTeammate"))))})})}let allPaths=document.getElementsByClassName("d3-path");PrunePathClasses(allPaths);for(let i=0;i<allPaths.length;i++)allPaths[i].id.includes(selectedPlayer)&&(allPaths[i].id.substring(5,5+selectedPlayer.length)==selectedPlayer?allPaths[i].classList.add("selectedPlayer"):allPaths[i].id.includes("Winner")||allPaths[i].id.includes("Winners")||allPaths[i].id.includes("Self kills")||allPaths[i].id.includes("Circular kills")||allPaths[i].id.includes("Environment")||allPaths[i].classList.add("killer"));let obits=document.getElementsByClassName("obit-name");for(i=0;i<obits.length;i++){let obitClassList=obits[i].classList;for(let j=obitClassList.length-1;j>=0;j--)"obit-name"!=obitClassList[j]&&obitClassList.remove(obitClassList[j]);axios_telemetry_response.data.allBotNames.split("|").includes(obits[i].innerText)&&obits[i].classList.add("botPlayer"),obits[i].innerText==selectedPlayer?obits[i].classList.add("selectedPlayer"):response.arrTeams.forEach(team=>{team.teammates.forEach(teammate=>{obits[i].innerText===teammate.name&&(team.teamId==selectedPlayerTeamId?obits[i].classList.add("playerTeammate"):team.teamId==selectedPlayerKillerTeamId&&(obits[i].innerText==selectedPlayerKiller?obits[i].classList.add("killer"):obits[i].classList.add("killerTeammate")))})})}let obitRows=document.getElementsByClassName("obituaryRow");for(i=0;i<obitRows.length;i++)obitRows[i].classList.remove("obituarySelected"),obitRows[i].id=="obit-"+selectedPlayer&&obitRows[i].classList.add("obituarySelected");SetRectangleLocation(selectedPlayer)}function PrunePathClasses(paths){for(let i=0;i<paths.length;i++)for(let j=paths[i].classList.length-1;j>=0;j--)"d3-path"!=paths[i].classList[j]&&"pathHidden"!=paths[i].classList[j]&&"pathDefault"!=paths[i].classList[j]&&paths[i].classList.remove(paths[i].classList[j])}function SetRectangleLocation(player){let playerCoorindates=document.getElementById(player).parentElement.transform.baseVal[0].matrix,translatedY=0;translatedY=playerCoorindates.f<0?playerCoorindates.f-glTreeHeightNeg:playerCoorindates.f+Math.abs(glTreeHeightNeg),playerRectangle=glPlayerRectangle,playerRectangle.x.baseVal.value=playerCoorindates.e,playerRectangle.y.baseVal.value=translatedY+6,playerRectangle.width.baseVal.value=document.getElementById(player).getComputedTextLength()+26;let existingChild=document.getElementById("g-child");document.getElementById("d3-svg01").insertBefore(playerRectangle,existingChild)}function stripBotText(name){return name.includes("bot.")&&(name=name.substring(6,name.length)),name}function btnSearchPlayer_Click(){""!=document.getElementById("inputPlayerName").value&&(searchDirection="up",match_floors=[0],match_floors_index=0,prelim(),history.replaceState("","",location.protocol+"//"+location.host+"?type=player&player="+strPlayerName+"&platform="+strPlatform))}function btnNext_Click(){""!=document.getElementById("inputPlayerName").value&&(searchDirection="up",match_floors_index++,prelim())}function btnPrevious_Click(){""!=document.getElementById("inputPlayerName").value&&(searchDirection="down",match_floors_index--,prelim())}function prelim(){strPlatform=document.querySelector("#slcPlatform option:checked").value,"!"==(strPlayerName=document.getElementById("inputPlayerName").value)[strPlayerName.length-1]?(bypassCache="y",strPlayerName=strPlayerName.slice(0,strPlayerName.length-1)):bypassCache="n",console.log(strLine),GetPlayerMatches()}function _printRoster(roster){var strRoster;return roster.forEach(element=>{strRoster+=element+", "}),strRoster}function openTwitter(){window.open("https://twitter.com/pubgtrees","_blank")}function drawRectangle(){let svg=document.getElementById("d3-svg01"),rect=document.getElementById("selectedPlayerRectangle");console.log(rect.x),rect.x.baseVal.value+=20}function ShowTreeHintModal(){document.getElementById("div-treehint-modal").style.display="block"}function HideTreeHintModal(){document.getElementById("div-treehint-modal").style.display="none"}window.addEventListener("load",event=>{vueSearchDiv.blTestingVersion=!0;let defaultPlayer=localStorage.getItem("defaultPlayer"),defaultPlatform=localStorage.getItem("defaultPlatform");null!=defaultPlayer&&(document.getElementById("inputPlayerName").value=defaultPlayer,document.getElementById("slcPlatform").value=defaultPlatform),document.getElementById("btnSearchPlayer").addEventListener("click",event=>{btnSearchPlayer_Click()}),document.getElementById("inputPlayerName").addEventListener("keyup",(function(event){event.preventDefault(),13===event.keyCode&&document.getElementById("btnSearchPlayer").click()})),document.getElementById("btnPreviousMatches").addEventListener("click",event=>{btnPrevious_Click()}),document.getElementById("btnNextMatches").addEventListener("click",event=>{btnNext_Click()}),document.getElementById("btnCopyMatchURL").addEventListener("click",event=>{btnCopyMatchToClipboard_Click()}),document.getElementById("btnCloseModal").addEventListener("click",event=>{HideModal()}),document.getElementById("btnCloseModal2").addEventListener("click",event=>{HideModal()}),document.getElementById("btnCloseTreeHintModal").addEventListener("click",event=>{HideTreeHintModal()}),document.getElementById("btnCloseTreeHintModal2").addEventListener("click",event=>{HideTreeHintModal()}),document.getElementById("div-modal").addEventListener("click",event=>{}),document.getElementById("div-d3-tree").addEventListener("click",event=>{blClickedPlayer?blClickedPlayer=!1:ClearTreeContext()}),chkDefault=document.getElementById("checkbox-setDefault"),chkDefault.addEventListener("change",event=>{chkDefault.checked?document.getElementById("lblDefault").textContent="Set as default player (now click Search)":document.getElementById("lblDefault").textContent="Set as default player"}),chkIncoming=document.getElementById("checkbox-incoming"),null!=localStorage.getItem("chkIncomingChecked")&&("true"==localStorage.getItem("chkIncomingChecked")?chkIncoming.checked=!0:chkIncoming.checked=!1),chkIncoming.addEventListener("change",event=>{localStorage.setItem("chkIncomingChecked",chkIncoming.checked),RunPlayerDamageReport(glSelectedPlayer)}),chkTeamId=document.getElementById("checkbox-teamId"),null!=localStorage.getItem("chkTeamId")&&("true"==localStorage.getItem("chkTeamId")?chkTeamId.checked=!0:chkTeamId.checked=!1,vuePlayerReport.isHideTeamId=!chkTeamId.checked),chkTeamId.addEventListener("change",event=>{localStorage.setItem("chkTeamId",chkTeamId.checked),vuePlayerReport.isHideTeamId=!chkTeamId.checked,RunPlayerDamageReport(glSelectedPlayer)}),chkShowTeamDeaths=document.getElementById("checkbox-teamDeaths"),null!=localStorage.getItem("chkShowTeamDeaths")&&("true"==localStorage.getItem("chkShowTeamDeaths")?chkShowTeamDeaths.checked=!0:chkShowTeamDeaths.checked=!1,vuePlayerReport.blShowTeamDeaths=chkShowTeamDeaths.checked),chkShowTeamDeaths.addEventListener("change",event=>{localStorage.setItem("chkShowTeamDeaths",chkShowTeamDeaths.checked),vuePlayerReport.blShowTeamDeaths=chkShowTeamDeaths.checked,RunPlayerDamageReport(glSelectedPlayer)}),document.getElementById("btnShowDamage").addEventListener("click",event=>{vuePlayerReport.isHidden?(document.getElementById("btnShowDamage").textContent="Hide details",chkIncoming.style.display="inline",lblIncoming.style.display="inline",chkTeamId.style.display="inline",document.getElementById("lblTeamId").style.display="inline",null!=localStorage.getItem("chkTeamId")&&("true"==localStorage.getItem("chkTeamId")?vuePlayerReport.isHideTeamId=!1:vuePlayerReport.isHideTeamId=!0),chkShowTeamDeaths.style.display="inline",document.getElementById("lblTeamDeaths").style.display="inline",localStorage.setItem("isHidden","false"),vuePlayerReport.isHidden=!1):(document.getElementById("btnShowDamage").textContent="Show details",chkIncoming.style.display="none",lblIncoming.style.display="none",chkTeamId.style.display="none",document.getElementById("lblTeamId").style.display="none",vuePlayerReport.isHideTeamId=!0,chkShowTeamDeaths.style.display="none",document.getElementById("lblTeamDeaths").style.display="none",localStorage.setItem("isHidden","true"),vuePlayerReport.isHidden=!0),RunPlayerDamageReport(glSelectedPlayer)}),null!=localStorage.getItem("isHidden")&&("true"==localStorage.getItem("isHidden")?(document.getElementById("btnShowDamage").textContent="Show details",chkIncoming.style.display="none",lblIncoming.style.display="none",chkTeamId.style.display="none",document.getElementById("lblTeamId").style.display="none",chkShowTeamDeaths.style.display="none",document.getElementById("lblTeamDeaths").style.display="none",vuePlayerReport.isHidden=!0):(document.getElementById("btnShowDamage").textContent="Hide details",chkIncoming.style.display="inline",lblIncoming.style.display="inline",chkTeamId.style.display="inline",document.getElementById("lblTeamId").style.display="inline",chkShowTeamDeaths.style.display="inline",document.getElementById("lblTeamDeaths").style.display="inline",vuePlayerReport.isHidden=!1)),glPlayerRectangle=document.getElementById("selectedPlayerRectangle"),checkURLQuery()}),window.addEventListener("keydown",event=>{"Escape"==event.key&&("none"!=document.getElementById("div-modal").style.display&&HideModal(),"none"!=document.getElementById("div-treehint-modal").style.display&&HideTreeHintModal())}),window.addEventListener("click",event=>{"div-modal"==event.target.id&&HideModal(),"div-treehint-modal"==event.target.id&&HideTreeHintModal()});